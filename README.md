# Zoom Daily Extraction System

A fully automated system that extracts Zoom session data from multiple accounts, organizes files in Google Drive, and maintains a real-time Google Sheets report.

## Overview

This system processes Zoom recordings from 4 accounts (3 users under primary account + 1 personal account) and extracts:
- **VTT transcripts** with timestamps
- **AI summaries** generated by Zoom
- **AI next steps** from Zoom AI
- **Smart Recording chapters** (if enabled)
- **Smart Recording highlights** (if enabled)
- **Zoom video URLs** for playback
- **Session metadata** (host, date, duration, etc.)

All files are automatically organized in Google Drive with proper folder structure and tracked in a persistent Google Sheets report.

## Features

- ✅ **Multi-account Support**: Processes 4 Zoom accounts simultaneously
- ✅ **Automated Daily Extraction**: Runs at 3 AM IST via cron job
- ✅ **Google Drive Integration**: Organizes files in structured folders
- ✅ **Google Sheets Reporting**: Real-time spreadsheet with all session data
- ✅ **Duplicate Prevention**: UUID-based deduplication with cleanup
- ✅ **Smart Recording Support**: Extracts chapters and highlights when available
- ✅ **Incremental Processing**: Only processes new sessions since July 12, 2025
- ✅ **Error Handling**: Comprehensive logging and error recovery
- ✅ **File Management**: Automatic cleanup of duplicate files

## System Architecture

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Zoom Accounts │────│  Daily Extraction │────│  Google Drive   │
│                 │    │     Script        │    │   Organization  │
│ • Primary (3)   │    │                   │    │                 │
│ • Personal (1)  │    │ • VTT Download    │    │ • Course Folders│
└─────────────────┘    │ • AI Extraction   │    │ • Session Folders│
                       │ • Smart Recording │    │ • File Storage  │
                       │ • Metadata Save   │    └─────────────────┘
                       └──────────────────┘              │
                                 │                       │
                                 │                       │
                       ┌──────────────────┐              │
                       │  Google Sheets   │──────────────┘
                       │     Report       │
                       │                  │
                       │ • Session List   │
                       │ • File URLs      │
                       │ • Auto-Update    │
                       │ • Deduplication  │
                       └──────────────────┘
```

## Installation

### Prerequisites

- Python 3.8+
- Conda environment (recommended)
- Google Service Account with Drive & Sheets API access
- Zoom Server-to-Server OAuth credentials

### Setup

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd zoom-extraction-system
   ```

2. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

3. **Configure environment variables**
   Create a `.env` file:
   ```bash
   # Zoom API Credentials (Primary Account)
   ZOOM_CLIENT_ID=your_zoom_client_id
   ZOOM_CLIENT_SECRET=your_zoom_client_secret
   ZOOM_ACCOUNT_ID=your_zoom_account_id
   
   # Zoom Personal Account API Credentials
   PERSONAL_ZOOM_CLIENT_ID=your_personal_zoom_client_id
   PERSONAL_ZOOM_CLIENT_SECRET=your_personal_zoom_client_secret
   PERSONAL_ZOOM_ACCOUNT_ID=your_personal_zoom_account_id
   
   # Google Drive API
   GOOGLE_CREDENTIALS_FILE=path/to/service-account.json
   GOOGLE_DRIVE_ROOT_FOLDER=your_drive_folder_id
   GOOGLE_SHARED_DRIVE_ID=your_shared_drive_id
   ```

4. **Set up Google Service Account**
   - Create a service account in Google Cloud Console
   - Enable Google Drive API and Google Sheets API
   - Download the service account JSON file
   - Share your Google Drive folder with the service account email

## Usage

### Manual Extraction

Run the extraction script manually:
```bash
python3 scripts/simple_daily_extraction.py
```

### Automated Daily Extraction

Set up the cron job:
```bash
# Edit crontab
crontab -e

# Add this line for daily execution at 3 AM IST
0 3 * * * source /path/to/project/.env && python3 /path/to/project/scripts/simple_daily_extraction.py > /path/to/project/logs/cron_daily_extraction.log 2>&1
```

### Google Sheets Report

The system automatically creates and maintains a Google Sheets report with these columns:
- Meeting Topic
- Host Name
- Host Email
- Date
- Duration (minutes)
- Transcript URL
- Meeting UUID
- Zoom Video URL
- AI Summary URL
- AI Next Steps URL
- Chapters URL
- Highlights URL

## File Structure

```
zoom-extraction-system/
├── scripts/
│   ├── simple_daily_extraction.py     # Main extraction script
│   └── generate_session_report.py     # Standalone report generator
├── app/
│   └── services/
│       ├── zoom_client.py             # Zoom API client
│       └── drive_manager.py           # Google Drive operations
├── config.py                          # Configuration settings
├── requirements.txt                   # Python dependencies
├── .env                              # Environment variables
└── logs/                             # Execution logs
```

## Configuration

### Zoom API Setup

1. **Create Zoom Server-to-Server OAuth App**
   - Go to Zoom Marketplace
   - Create a Server-to-Server OAuth app
   - Get Client ID, Client Secret, and Account ID
   - Add required scopes: `recording:read:admin`, `user:read:admin`

2. **Configure Multiple Accounts**
   - Set up primary account credentials
   - Set up personal account credentials
   - Ensure both accounts have recording permissions

### Google Drive Setup

1. **Create Google Cloud Project**
   - Enable Google Drive API
   - Enable Google Sheets API
   - Create service account
   - Download JSON credentials

2. **Share Drive Folder**
   - Share your target folder with service account email
   - Grant "Content Manager" permissions
   - Copy the folder ID from the URL

### Smart Recording

To enable Smart Recording features:
1. Go to Zoom web portal
2. Navigate to Settings → Recording
3. Enable "Smart Recording" features
4. Future meetings will include chapters and highlights

## Folder Structure

The system organizes files in Google Drive as:
```
Root Folder/
├── Course Name 1/
│   └── Session Name_YYYY-MM-DD/
│       ├── transcript.vtt
│       ├── ai_summary.json
│       ├── ai_next_steps.json
│       ├── smart_chapters.json
│       ├── smart_highlights.json
│       ├── zoom_video_url.txt
│       └── session_metadata.json
└── Course Name 2/
    └── Session Name_YYYY-MM-DD/
        └── [files...]
```

## Logging

The system generates detailed logs:
- Daily extraction logs: `logs/daily_extraction_YYYYMMDD.log`
- Cron job logs: `logs/cron_daily_extraction.log`
- Error tracking and session processing details

## Troubleshooting

### Common Issues

1. **Permission Errors**
   - Ensure service account has correct permissions
   - Check if Google APIs are enabled

2. **Missing Files**
   - Verify Zoom API scopes are correct
   - Check if recordings are available (24-48 hour delay)

3. **Duplicate Files**
   - System automatically cleans up duplicates
   - Check logs for cleanup operations

### Monitoring

Monitor the system by checking:
- Daily log files for errors
- Google Sheets report for new sessions
- Google Drive folder for file organization

## API Limits

- **Zoom API**: 100 requests per day for basic plan
- **Google Drive API**: 1000 requests per 100 seconds
- **Google Sheets API**: 300 requests per minute

## Security

- All credentials stored in `.env` file
- Service account authentication for Google APIs
- OAuth 2.0 for Zoom API access
- No secrets committed to repository

## Performance

- Processes ~5 sessions in 2-3 minutes
- Handles multiple accounts concurrently
- Automatic duplicate cleanup
- Efficient incremental processing

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test thoroughly
5. Submit a pull request

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Support

For issues or questions:
1. Check the troubleshooting section
2. Review the logs for error details
3. Ensure all prerequisites are met
4. Verify API credentials and permissions

## Changelog

### v1.0.0 (2025-07-15)
- Initial release
- Multi-account Zoom extraction
- Google Drive organization
- Google Sheets reporting
- Automated cron job setup
- Smart Recording support
- Duplicate file cleanup